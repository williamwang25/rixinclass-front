# 🚀 快速开始指南

## 1️⃣ 准备工作（5分钟）

### 检查环境

确保你已经：
- ✅ 安装了微信开发者工具
- ✅ 开通了微信云开发服务
- ✅ 创建了云开发环境
- ✅ 导入了数据库表（rixindb.sql）

---

## 2️⃣ 部署云函数（10分钟）

### 步骤1: 上传 login 云函数

1. 打开微信开发者工具
2. 找到 `cloudfunctions/login` 文件夹
3. **右键** → 选择 **「上传并部署：云端安装依赖」**
4. 等待上传完成（约2-3分钟）

### 步骤2: 上传 getUserInfo 云函数

重复步骤1，上传 `cloudfunctions/getUserInfo` 文件夹

### 步骤3: 确认部署成功

1. 点击微信开发者工具顶部的 **「云开发」** 按钮
2. 进入 **「云函数」** 页面
3. 看到 `login` 和 `getUserInfo` 两个云函数状态为 **「正常」**

---

## 3️⃣ 配置云开发环境（2分钟）

### 获取环境ID

1. 在云开发控制台，点击左上角的 **「设置」**
2. 复制 **「环境ID」**（类似 `cloud1-xxx`）

### 配置 App.vue

打开 `src/App.vue`，在 `onLaunch` 中添加：

```javascript
export default {
  onLaunch() {
    // 初始化云开发
    wx.cloud.init({
      env: 'cloud1-xxx', // 替换为你的环境ID
      traceUser: true
    });
    
    console.log('云开发初始化完成');
  }
}
```

---

## 4️⃣ 运行测试（5分钟）

### 访问测试页面

在微信开发者工具中，访问测试页面：

**方法1：直接输入路径**
```
/pages-sub/test/auth
```

**方法2：通过首页跳转**

在任意页面添加临时按钮：
```vue
<button @click="goTest">测试云函数</button>

<script>
const goTest = () => {
  uni.navigateTo({
    url: '/pages-sub/test/auth'
  });
};
</script>
```

### 执行测试

**测试1: 登录**
1. 点击 **「🚀 执行登录测试」**
2. 授权获取用户信息
3. 查看结果（应该显示 ✅ 成功）

**测试2: 获取用户信息**
1. 用户ID会自动填充
2. 点击 **「🔍 查询用户信息」**
3. 查看结果（应该显示用户详细信息）

---

## 5️⃣ 验证数据库（2分钟）

### 查看用户记录

1. 进入云开发控制台
2. 点击 **「数据库」**
3. 选择 **「rx_user」** 表
4. 应该能看到刚才登录的用户记录

### 检查字段

确认以下字段有值：
- `user_id` - 自增ID
- `open_id` - 微信OpenID
- `nick_name` - 用户昵称
- `avatar` - 头像URL
- `user_type` - 0（教师）
- `status` - 1（正常）
- `latest_visit_at` - 最后访问时间
- `created_at` - 创建时间

---

## ✅ 成功标志

如果看到以下结果，说明部署成功：

- ✅ 测试页面显示 **「✅ 成功」** 状态
- ✅ 能看到完整的用户信息
- ✅ 数据库中有新增的用户记录
- ✅ 云函数日志中没有错误信息

---

## ⚠️ 常见错误及解决

### 错误1: "cloud init error"

**原因：** 未初始化云开发

**解决：** 检查 App.vue 中的 `wx.cloud.init()` 配置

---

### 错误2: "无法获取用户身份信息"

**原因：** 不在真实的微信小程序环境

**解决：** 确保在微信开发者工具中运行，不要在浏览器中测试

---

### 错误3: "数据库表不存在"

**原因：** 未导入数据库表

**解决：** 
1. 进入云开发控制台 → 数据库
2. 导入 `!prompt/rixindb.sql` 文件

---

### 错误4: "云函数不存在"

**原因：** 云函数未部署或部署失败

**解决：**
1. 检查云开发控制台 → 云函数列表
2. 重新上传部署云函数
3. 查看云函数日志确认错误

---

## 🎉 完成！

恭喜你完成了 **阶段1: 用户认证模块** 的部署和测试！

### 下一步

完成测试后，可以进入：

**🔜 阶段2: 实验室模块**
- `getLabList` - 实验室列表查询
- `getLabDetail` - 实验室详情查询

---

## 📞 需要帮助？

如果遇到问题：
1. 查看 `cloudfunctions/README.md` 详细文档
2. 查看云函数日志
3. 查看云开发控制台错误信息
4. 联系开发团队

---

**预计总耗时：20-30分钟**

祝你部署顺利！🚀

